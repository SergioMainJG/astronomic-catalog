---
import Layout from "../layouts/Layout.astro";
import type { CelestialObjectWithType } from "../types";

let celestialObjects: CelestialObjectWithType[] = [];
const API_URL = import.meta.env.INTERNAL_API_URL || "http://localhost:3000";
try {
	const response = await fetch(`${API_URL}/homepage`);
	if (response.ok) {
		celestialObjects = await response.json();
	} else {
		console.error("Failed to fetch homepage data:", response.status);
	}
} catch (error) {
	console.error("Error fetching homepage data:", error);
}
---

<Layout title="Astronomic Catalog - Home">
	<div class="space-y-8">
		<header class="text-center">
			<h1
				class="text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500"
			>
				Celestial Objects
			</h1>
			<p class="mt-4 text-xl text-slate-400">
				Explore the hierarchy of the cosmos.
			</p>
		</header>

		<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
			{
				celestialObjects.map((obj) => (
					<div class="bg-slate-800 rounded-lg overflow-hidden shadow-lg border border-slate-700 hover:border-blue-500 transition-colors duration-300">
						{obj.imageUrl ? (
							<img
								src={obj.imageUrl}
								alt={obj.globalName}
								class="w-full h-48 object-cover"
							/>
						) : (
							<div class="w-full h-48 bg-slate-700 flex items-center justify-center text-slate-500">
								No Image
							</div>
						)}
						<div class="p-6">
							<div class="flex items-center justify-between mb-2">
								<h2 class="text-xl font-bold text-white">{obj.globalName}</h2>
								<span class="px-2 py-1 text-xs font-semibold text-blue-900 bg-blue-200 rounded-full">
									{obj.objectType}
								</span>
							</div>
							<p class="text-slate-300 line-clamp-3 mb-4">{obj.description}</p>
						</div>
					</div>
				))
			}
		</div>
	</div>
</Layout>
