---
import Layout from "../layouts/Layout.astro";
import type { Orbit } from "../types";

let orbits: Orbit[] = [];
try {
	const response = await fetch("http://localhost:3000/jerarchy-planet");
	if (response.ok) {
		orbits = await response.json();
	}
} catch (e) {
	console.error("Failed to fetch orbits", e);
}
---

<Layout title="Astronomic Catalog - Orbits">
	<div class="space-y-8">
		<header>
			<h1 class="text-3xl font-bold text-white">Planetary Orbits</h1>
			<p class="text-slate-400">
				Distance relationships between stars and planets.
			</p>
		</header>

		<div
			class="overflow-hidden rounded-xl border border-slate-700 bg-slate-800"
		>
			<table class="min-w-full divide-y divide-slate-700">
				<thead class="bg-slate-900">
					<tr>
						<th
							scope="col"
							class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-slate-400"
							>Star Name</th
						>
						<th
							scope="col"
							class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-slate-400"
							>Planet Name</th
						>
						<th
							scope="col"
							class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-slate-400"
							>Distance (AU)</th
						>
						<th
							scope="col"
							class="px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-slate-400"
							>Action</th
						>
					</tr>
				</thead>
				<tbody class="divide-y divide-slate-700 bg-slate-800">
					{
						orbits.map((orbit) => (
							<tr class="hover:bg-slate-700/50 transition-colors">
								<td class="whitespace-nowrap px-6 py-4">
									<div class="flex items-center">
										<div class="h-8 w-8 rounded-full bg-yellow-500/20 border border-yellow-500/50 flex items-center justify-center text-yellow-500 text-xs">
											â˜…
										</div>
										<div class="ml-4 font-medium text-white">
											{orbit.primaryBody?.globalName}
										</div>
									</div>
								</td>
								<td class="whitespace-nowrap px-6 py-4 text-slate-300">
									{orbit.celestialObject?.globalName}
								</td>
								<td class="whitespace-nowrap px-6 py-4 text-slate-300 font-mono">
									{orbit.semiMajorAxis}
								</td>
								<td class="whitespace-nowrap px-6 py-4 text-right text-sm font-medium">
									<a href={`/planets/${orbit.celestialObject?.id}`} class="text-blue-400 hover:text-blue-300 transition-colors bg-blue-500/10 px-3 py-1.5 rounded-md hover:bg-blue-500/20">
										View Details
									</a>
								</td>
							</tr>
						))
					}
				</tbody>
			</table>
		</div>
	</div>
</Layout>
